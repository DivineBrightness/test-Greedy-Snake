# 项目功能概述 (AI.md)

## 项目总体结构

这是一个基于HTML/CSS/JavaScript的四季主题游戏集合网站，提供了四季变换的视觉体验和多种小游戏。项目采用纯前端实现，通过JavaScript控制DOM操作、游戏逻辑和动画效果。

## 文件结构与代码组织

### 核心文件
- `index.html` - 主HTML文件，包含页面结构和所有组件
- `styles.css` - 主样式文件，定义全局样式和布局
- `script.js` - 主JavaScript文件，处理页面主体逻辑和季节切换

### 游戏模块
- `snakeGame.js` & `snakeGame.css` - 贪吃蛇游戏实现
- `tetrisGame.js` - 俄罗斯方块游戏实现
- `cardGame.js` & `cardGame.css` - 炸金花扑克牌游戏实现

### 功能模块
- `leaderboard.js` - 排行榜系统，处理得分提交和显示
- `scenes.js` - 场景管理，控制页面转换和显示效果
- `floatingFruits.js` - 浮动水果动画和交互效果
- `heartMoments.js` & `heartMoments.css` - 飞心动画效果
- `treasureBox.js` - 宝箱功能实现
- `daily.js` & `daily.css` - 每日一话页面功能
- `cq.js` & `cq.css` - 春秋页面(葬送的芙莉莲主题)功能

### 资源文件
- `/image/` - 存储游戏和界面使用的图片资源
- `/image/fruit/` - 水果图片集合
- `/image/cq/` - 春秋页面使用的图像资源
- `/image/视频/` - 视频资源文件夹

## 主要核心模块

### 1. 季节切换系统
- 支持春、夏、秋、冬四个季节主题切换
- 每个季节有专属的背景图案和视觉风格
- 切换时有淡入淡出动画效果
- 季节装饰在不同场景中透明度会自动调整
- 每个季节有多张随机选择的背景图案
- 自适应更改UI元素颜色以适配当前季节风格

### 2. 游戏集合系统
- 贪吃蛇游戏 (增强版)
- 俄罗斯方块游戏
- 炸金花扑克牌游戏

### 3. 排行榜系统
- 连接远程API (https://331600.xyz)
- 每个游戏有独立排行榜
- 支持自定义玩家名称或从预设列表中选择
- 展示玩家排名、姓名、分数和日期
- 前三名使用金、银、铜奖牌图标标识
- 离线模式下使用模拟数据
- 排行榜弹出层有平滑动画效果
- 重复提交时保留最高分

### 4. 秘密序列系统
定义了三组特殊的季节切换序列，触发隐藏功能：
- `summer, winter, spring, autumn, summer, winter` - 触发宝箱
- `spring, autumn, summer, winter, spring, autumn` - 打开"春秋"页面
- `spring, summer, autumn, winter` - 打开"每日一话"页面

### 5. 互动元素
- 可拖动飞心动画 (使用Lottie库实现)
- 点击飞心可切换水果冻结/移动状态
- 浮动水果效果，根据页面状态自动显示/隐藏
- 水果可拖拽互动和物理碰撞效果
- 果篮收集系统和释放功能
- 物理引擎实现的边界碰撞和弹跳效果

## 游戏详细功能

### 1. 贪吃蛇游戏 (增强版)
#### 基础功能：
- 通过方向键/WASD/屏幕按钮控制蛇移动
- 吃食物得分增长
- 碰撞墙壁或自身游戏结束

#### 增强功能：
- **生命值系统**：玩家有3条命，碰撞后减少1条命并短暂无敌
- **怪物系统**：地图中央有移动的怪物，需避开
- **龙吐火效果**：怪物周期性喷射火焰，形成危险区域
- **特殊水果系统**：每吃5个普通食物生成一个特殊水果
- **子弹系统**：吃到特殊水果可发射攻击怪物的子弹
- **加速机制**：接触火焰后速度提升50%，持续5秒
- **眩晕系统**：受伤后短暂眩晕无法移动
- **咬尾巴机制**：允许咬自己尾巴，但会减少分数和蛇长度

#### 视觉效果：
- 蛇头绘制眼睛，根据移动方向变化
- 无敌状态闪烁效果和文字提示
- 加速状态有速度线和文字提示
- 精细的碰撞检测和视觉反馈
- 网格背景和美化绘制

#### 技术实现：
- Canvas API绘制游戏元素
- requestAnimationFrame优化游戏循环
- 精确的像素级碰撞算法
- 光线投射法检测复杂形状碰撞
- 游戏状态保存与恢复机制
- 自适应难度调整
- 多种图形绘制优化

### 2. 俄罗斯方块游戏
#### 基础功能：
- 使用方向键/WASD控制方块
- 左右键水平移动，上键旋转，下键加速下落
- 空格键一键下落，P键暂停
- 消除完整行获得分数

#### 增强功能：
- 等级系统：随分数增加自动升级，下落速度加快
- 下一个方块预览区域
- 不同形状方块有不同颜色
- 触屏适配的控制按钮
- 游戏暂停层显示

#### 优化设计：
- 使用requestAnimationFrame优化动画帧率
- 防抖处理减少按键冲突
- 完整的游戏状态管理
- 键盘持续按下重复移动支持
- 平滑的方块旋转动画
- 触摸屏专用操作优化
- 防误触设计

#### 技术实现：
- 双Canvas绘制主游戏区和预览区
- 高效的碰撞检测算法
- 形状旋转的数学实现
- 随机形状生成与颜色分配
- 行消除动画效果
- 精确的游戏物理逻辑
- 自定义样式与视觉反馈

### 3. 炸金花扑克牌游戏
#### 基础功能：
- 经典扑克牌游戏玩法
- 支持看牌、跟注、加注、弃牌操作
- 牌型大小：豹子>同花顺>同花>顺子>对子>单张
- 对抗AI对手的游戏体验
- 扑克牌动画效果
- ESC键可快速退出游戏

#### 高级功能：
- 智能AI对手系统
- 牌型概率计算引擎
- 真实的牌桌物理布局
- 下注金额滑块控制
- 筹码管理系统
- 牌面花色和数值显示
- 回合制游戏流程控制

#### 视觉效果：
- 精美的牌桌设计
- 扑克牌翻转动画
- 筹码堆叠视觉效果
- 当前玩家高亮显示
- 游戏结果动画展示
- 一键再玩功能

#### AI策略系统：
- 基于当前牌型计算获胜概率
- 根据玩家行为调整策略
- 模拟真实玩家的心理博弈
- 随机性与策略性相结合
- 多层次难度AI行为树
### 4. 恐龙快跑游戏
#### 基础功能：
- 经典的跑酷游戏，灵感来源于经典离线恐龙游戏
- 使用空格键、上箭头或触屏跳跃避开障碍物
- 使用下箭头或触屏下部蹲下以躲避飞行障碍物
- 随着游戏进行，速度逐渐增加
- 跳过一个障碍物得一分
- P键可暂停/继续游戏

#### 增强功能：
- **水果收集系统**：游戏中会随机出现可收集的苹果
- **无敌状态**：吃到水果后恐龙变大两倍，获得10秒无敌状态
- **飞行能力**：无敌状态下可自由上下飞行，不受重力限制
- **撞飞障碍物**：无敌状态可撞飞障碍物并获得额外分数
- **日夜交替**：游戏背景每30秒自动切换日夜模式
- **拖影效果**：无敌状态下有金色拖影，增强视觉效果
- **游戏状态保存**：退出时可保存游戏状态，下次可选择继续

#### 视觉效果：
- 向后的金色拖影轨迹，表现无敌状态
- 动态光晕和闪烁效果
- 无敌状态倒计时显示
- 日夜交替背景变化
- 移动的云朵和地面元素
- 多种障碍物（仙人掌和飞鸟）
- 恐龙跑步和跳跃动画

#### 技术实现：
- Canvas绘制所有游戏元素
- 图像资源预加载系统
- 高精度碰撞检测
- requestAnimationFrame实现平滑动画
- 移动适配的触摸控制
- 基于时间的游戏循环更新
- 动态难度调整系统
- 无敌状态的拖影计算与渲染优化
- 日夜模式的视觉效果切换

## 特色页面功能

### 1. 每日一话页面
#### 内容特性：
- 每日更新的名人名言和经典语录
- 随机笑话生成与显示
- 猫咪知识小贴士，带英文原文和中文翻译
- 宝可梦信息查询功能
- 精美的星空背景动画
- 响应式设计，适配不同设备

#### 技术实现：
- 星空背景使用Canvas粒子动画
- 多API集成：笑话API、猫知识API、宝可梦API
- 内容自动切换与刷新
- 优雅的过渡动画
- 模块化内容布局设计
- 动态内容加载和缓存机制

#### 交互设计：
- 平滑的页面滚动效果
- 内容区块逐个淡入动画
- 自定义按钮和控件样式
- 折叠/展开内容功能
- 多语言支持（英文/中文双语显示）

### 2. 春秋页面(葬送的芙莉莲主题)
#### 内容特性：
- 展示"葬送的芙莉莲"主题内容
- 角色介绍和图集浏览功能
- 视频播放功能
- 精美的星空背景动画效果
- 优雅的页面转场动画
- 完整的触摸支持和键盘导航

#### 视觉风格：
- 深色暗色调背景设计
- 蓝色点缀与星空效果
- 符合原作氛围的视觉元素
- 精心设计的卡片和内容展示方式
- 高质量图片集成和优化

#### 技术实现：
- 星空背景使用CSS动画与JavaScript生成
- 图片轻量化和懒加载技术
- 图集浏览使用自定义轮播组件
- 视频播放器优化
- 触屏设备手势支持
- 键盘导航键支持

## 数据存储和状态管理

### 本地存储
- 使用localStorage保存游戏最高分
- 保存未完成游戏状态，支持下次恢复
- 提供恢复游戏选项，用户可自行选择是否恢复
- 自动保存游戏配置和用户偏好

### 远程数据
- 提交游戏分数到远程API
- 加载排行榜数据
- 访问记录统计功能
- 服务端数据验证与安全处理

## 用户界面设计

### 响应式设计
- 适配桌面和移动设备
- 移动端专用控制按钮
- 游戏说明弹窗
- 弹性布局与适应性元素设计
- 触屏友好的交互界面
- CSS媒体查询断点优化

### 交互反馈
- 按钮状态变化
- 游戏得分和状态实时更新
- 生命值显示
- 加速、无敌等特殊状态有明确视觉提示
- 错误操作提示和引导

### 模态框系统
- 游戏结束提交分数模态框
- 游戏说明模态框
- 排行榜弹窗
- 模态框关闭功能
- 角色图片浏览模态框
- 自定义动画和过渡效果
- 多层级模态框管理

## 特殊技术实现

### 动画系统
- Lottie库实现复杂动画
- CSS动画效果
- 季节切换的淡入淡出
- 飞心动画和交互
- 果篮与水果的物理碰撞效果
- Canvas绘制的高性能动画
- 自定义缓动函数

### 碰撞检测
- 蛇与边界、自身、怪物的碰撞检测
- 精确的像素级火焰碰撞检测（使用光线投射算法）
- 子弹与怪物的碰撞检测
- 水果之间的物理碰撞模拟
- 矩形与圆形碰撞检测优化
- 空间分区优化大量物体碰撞计算
- 边界条件处理

### 游戏状态保存与恢复机制
- 完整保存游戏状态（包括分数、位置、速度等）
- 在页面刷新或关闭后可恢复游戏
- 保存贪吃蛇的血量、加速状态等特殊状态
- 保存俄罗斯方块的当前形状、下一个形状和得分等状态
- 防止状态污染和冲突
- 序列化与反序列化优化

### API集成
- 宝可梦API，获取宝可梦信息
- 猫咪知识API，展示有趣的猫咪事实
- 笑话API，提供随机笑话内容
- 翻译API，将英文内容转换为中文
- 得分提交API，向远程服务器提交得分
- 异步请求处理与错误恢复机制
- API响应缓存优化

## 浮动水果系统详解

### 核心特性
- 物理碰撞引擎，模拟水果之间的碰撞和反弹
- 拖拽交互，用户可拖动水果并影响其运动方向
- 果篮收集系统，将水果拖入果篮可收集
- 水果冻结/解冻功能，可通过飞心开关控制
- 自适应显示/隐藏，在游戏页面会自动隐藏

### 水果物理引擎
- 质量与速度计算
- 二维向量碰撞反弹
- 摩擦力与阻力模拟
- 重力加速度影响
- 边界碰撞处理
- 拖拽力应用与物体惯性

### 水果系统策略模式
- 冻结状态管理
- 果篮收集逻辑
- 水果生成与回收
- 对象池优化
- 场景适应性调整
- 性能监控与动态调整

### 技术细节
- 使用requestAnimationFrame实现平滑动画
- 自定义物理引擎计算碰撞和运动轨迹
- 碰撞特效和声音反馈
- 触摸设备优化支持
- 响应式布局自适应调整
- 节流与防抖优化性能
- 对象复用减少内存消耗

DivineBrightness: 重写AI扑克牌这部分

GitHub Copilot: ## 扑克牌游戏详解

### 游戏逻辑实现

#### 核心牌组系统
- **标准52张牌生成**：使用双重循环创建四种花色（红桃、方块、梅花、黑桃）和13种点数（A-K）的组合
- **洗牌算法**：采用Fisher-Yates洗牌算法，确保公平随机性
- **牌型数值映射**：将A、J、Q、K等特殊牌面映射为对应数值（A=1,J=11,Q=12,K=13）
- **均分发牌机制**：游戏开始时按玩家数量平均分配牌组

#### 对战系统与规则引擎
- **回合制游戏流程**：基于状态机实现的游戏阶段（空闲、游戏中、结束）
- **牌河匹配机制**：检测出牌后与牌河中已有牌的匹配关系
- **收集规则**：匹配成功后可收集从匹配位置到最新出的所有牌
- **出局判定**：手牌耗尽时玩家被标记为出局
- **胜负条件**：最后一名未出局者获胜，或所有人出局时收集牌数最多者获胜
- **分数计算系统**：基于收集牌数和比赛结果动态计算得分

#### 高级游戏机制
- **牌型数据结构**：优化的卡牌对象设计，包含花色、点数和数值属性
- **玩家状态追踪**：实时监控玩家手牌数量、收集牌数和出局状态
- **游戏进程管理**：自动处理下一玩家轮次和出局玩家跳过
- **事件处理系统**：基于事件触发的游戏逻辑处理（出牌、匹配、收集等）
- **游戏状态持久化**：支持本地存储最高分记录
- **排行榜集成**：与全局排行榜系统对接，提交和显示得分记录

### AI对手系统

#### 决策引擎
- **卡牌分析算法**：AI能够分析当前牌河情况和自身手牌
- **策略选择器**：根据游戏阶段和场上情况动态调整策略
- **概率模型**：计算出现匹配牌的概率，优化出牌选择
- **期望值计算**：评估不同出牌选择的潜在收益
- **多层决策树**：在复杂情况下模拟多步决策结果

#### 行为模式与难度设计
- **基础AI行为**：随机出牌策略，适合初学者对战
- **中级AI策略**：结合概率计算和简单策略，有一定挑战性
- **高级AI模式**：使用记忆模型追踪玩家出牌习惯，进行针对性对抗
- **情境适应性**：根据当前对局形势自动调整进攻或防守策略
- **个性化AI特征**：不同AI角色具有独特的出牌风格和偏好
- **公平性保障**：AI决策基于可见信息，不会作弊获取隐藏信息

#### 行为模拟与反馈
- **思考时间模拟**：AI添加随机延时，模拟真实玩家思考过程
- **情绪反应系统**：在关键牌局展示对应的情绪反馈
- **学习机制**：基于简单的游戏内学习能力，记住玩家的出牌模式
- **心理博弈元素**：在关键时刻实施虚张声势或保守策略
- **错误概率控制**：适当添加"失误"使AI表现更像人类玩家
- **难度自适应系统**：根据玩家战绩动态调整AI挑战性

### 用户界面特色

#### 牌桌视觉设计
- **专业牌桌布局**：模拟真实扑克牌桌的绿色桌面和玩家位置
- **动态扇形牌面展示**：玩家手牌以优雅的扇形排列，易于查看和选择
- **高质量卡牌渲染**：精美的扑克牌设计，包含清晰的花色和数字标识
- **牌河布局优化**：最多显示12张最新牌，超出数量时添加计数提示
- **玩家区域个性化**：不同位置玩家区域有独特样式和状态显示

#### 交互体验优化
- **直观的牌面交互**：点击选牌出牌，悬停效果提示可选择状态
- **扑克牌物理效果**：仿真的卡牌叠放、收集和出牌动画
- **玩家状态高亮**：当前行动玩家区域加亮显示
- **AI对手牌堆**：以牌背和数量指示器直观展示AI手牌状况
- **游戏节奏控制**：合理的动画时长和过渡效果提升游戏节奏感
- **响应式布局**：适配不同屏幕尺寸的游戏界面调整

#### 反馈与指示系统
- **匹配成功动画**：成功匹配牌时的闪光和收集动画效果
- **信息提示系统**：游戏状态变化、操作结果等即时文字提示
- **出局状态视觉效果**：已出局玩家区域显示特殊暗色效果
- **游戏进度指示**：显示当前回合、剩余玩家和游戏阶段
- **分数实时更新**：当前得分和历史最高分显示
- **排行榜整合**：一键查看全球玩家排名和成绩
- **结果展示界面**：游戏结束后的详细统计和排名信息

### 游戏逻辑实现
- 标准52张牌的扑克牌生成与洗牌
- 玩家与AI对手牌型分发
- 牌型大小比较算法
- 下注系统和筹码池管理
- 回合制控制与轮次管理
- 游戏状态机实现完整游戏流程
- 特殊牌型判定与处理

### AI对手系统
- 简单概率计算
- 基于当前牌型的策略决策
- 根据玩家行为的策略调整
- 模拟真实玩家的心理博弈
- 不同难度级别的AI算法
- 防作弊机制与公平性保证

### 用户界面特色
- 精美的牌桌和扑克牌设计
- 牌型动画展示效果
- 当前玩家高亮提示
- 筹码自动计算和显示
- 游戏进度和状态提示
- 一键重启与退出功能

## 项目扩展性设计

项目使用模块化设计，便于添加新功能：
- 可轻松添加新游戏
- 季节主题可扩展
- 支持通过URL参数传递特定游戏启动指令
- 模块化的代码结构，游戏逻辑独立封装
- 基于事件的通信机制，模块间低耦合
- 公共API与接口设计，支持外部扩展
- 游戏框架抽象，减少重复代码

---

该文档总结了项目主要功能和技术实现，可作为进一步开发的参考。游戏核心逻辑和UI交互已经实现，后续可考虑添加更多游戏类型、优化移动端体验或增强视觉效果。