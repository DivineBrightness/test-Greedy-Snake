<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>四季风景 & 贪吃蛇</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    
    body {
      background-color: #f5f5f7;
      color: #1d1d1f;
      transition: background-color 1s ease;
      overflow-x: hidden;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }
    
    h1 {
      font-size: 48px;
      font-weight: 600;
      margin: 40px 0;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .season-container {
      height: 500px;
      margin: 40px 0;
      position: relative;
      overflow: hidden;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .pixel-art {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      transition: transform 1s ease, opacity 1s ease;
      opacity: 0;
      transform: translateX(100%);
      position: absolute;
      top: 0;
      left: 0;
    }
    
    .pixel-art.active {
      opacity: 1;
      transform: translateX(0);
    }
    
    .pixel-grid {
      display: grid;
      grid-template-columns: repeat(32, 1fr);
      grid-template-rows: repeat(32, 1fr);
      width: 400px;
      height: 400px;
      margin: 0 auto;
    }
    
    .pixel {
      width: 100%;
      height: 100%;
    }
    
    .season-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 40px 0;
    }
    
    .season-btn, .game-btn {
      padding: 15px 30px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      background-color: #fff;
      color: #1d1d1f;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    
    .season-btn:hover, .game-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    
    .season-btn.active {
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
      color: white;
    }
    
    .game-btn {
      background: linear-gradient(45deg, #43c6ac, #f8ffae);
      color: #1d1d1f;
      margin-top: 20px;
    }
    
    .spring-btn:hover { background-color: #ffccd5; }
    .summer-btn:hover { background-color: #fdffb6; }
    .autumn-btn:hover { background-color: #ffd6a5; }
    .winter-btn:hover { background-color: #a0c4ff; }
    
    footer {
      margin-top: 60px;
      padding: 20px;
      font-size: 14px;
      color: #86868b;
    }
    
    body.spring { background-color: #f8f5ff; }
    body.summer { background-color: #fffbe5; }
    body.autumn { background-color: #fff5eb; }
    body.winter { background-color: #f0f8ff; }
    
    #snake-game {
      display: none;
      margin: 0 auto;
      max-width: 500px;
    }
    
    #game-canvas {
      border: 2px solid #333;
      border-radius: 10px;
      background-color: #f0f0f0;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .game-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    
    .game-score {
      font-size: 24px;
      font-weight: bold;
      color: #333;
    }
    
    .game-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .control-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      background: linear-gradient(45deg, #4ecdc4, #556270);
      color: white;
    }
    
    .control-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .game-instructions {
      color: #666;
      margin-bottom: 20px;
      padding: 15px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }
    
    @media (max-width: 768px) {
      h1 { font-size: 36px; }
      .season-controls { flex-wrap: wrap; }
      .pixel-grid { width: 300px; height: 300px; }
      .season-container { height: 400px; }
      #game-canvas { width: 100%; height: auto; }
    }
    .mobile-controls {
  display: none;
  justify-content: center;
  align-items: center;
  margin-top: 20px;
  width: 100%;
}

.control-row {
  display: flex;
  justify-content: center;
  gap: 10px;
}

.direction-btn {
  width: 60px;
  height: 60px;
  font-size: 24px;
  padding: 0;
  border-radius: 15px; /* 稍微圆润一点 */
}

/* 调整手机端显示 */
@media (max-width: 768px) {
  .mobile-controls {
    display: block; /* 改为 block 以适应垂直排列 */
  }
  .control-row:nth-child(1) {
    margin-bottom: 10px; /* 上按钮与下排的间距 */
  }
  .control-row:nth-child(2) {
    justify-content: space-between; /* 左右按钮分开 */
    max-width: 200px; /* 控制下排宽度 */
    margin: 0 auto;
  }
  .control-row:nth-child(2) .direction-btn:nth-child(2) {
    margin: 0 20px; /* 下按钮与左右按钮的间距 */
  }
  .game-instructions p:first-child::after {
    content: "，或使用下方按钮控制";
  }
}
  </style>
</head>
<body class="spring">
  <div class="container">
    <h1>四季风景</h1>
    
    <div class="season-container">
      <div class="pixel-art active" id="spring">
        <div class="pixel-grid" id="spring-grid"></div>
      </div>
      <div class="pixel-art" id="summer">
        <div class="pixel-grid" id="summer-grid"></div>
      </div>
      <div class="pixel-art" id="autumn">
        <div class="pixel-grid" id="autumn-grid"></div>
      </div>
      <div class="pixel-art" id="winter">
        <div class="pixel-grid" id="winter-grid"></div>
      </div>
    </div>
    
    <div class="season-controls">
      <button class="season-btn spring-btn active" data-season="spring">春季</button>
      <button class="season-btn summer-btn" data-season="summer">夏季</button>
      <button class="season-btn autumn-btn" data-season="autumn">秋季</button>
      <button class="season-btn winter-btn" data-season="winter">冬季</button>
    </div>
    
    <button class="game-btn" id="snake-game-btn">进入贪吃蛇游戏</button>
    
    <div id="snake-game">
      <h2 style="margin-bottom: 20px;">贪吃蛇小游戏</h2>
  <div class="game-info">
    <div class="game-score">分数: <span id="score">0</span></div>
    <div class="game-high-score">最高分: <span id="high-score">0</span></div>
  </div>
  <canvas id="game-canvas" width="400" height="400"></canvas>
  <div class="game-controls">
    <button class="control-btn" id="start-btn">开始游戏</button>
    <button class="control-btn" id="pause-btn">暂停</button>
    <button class="control-btn" id="back-btn">返回风景</button>
  </div>
  <div class="mobile-controls">
    <div class="control-row">
      <button class="control-btn direction-btn" id="up-btn">↑</button>
    </div>
    <div class="control-row">
      <button class="control-btn direction-btn" id="left-btn">←</button>
      <button class="control-btn direction-btn" id="down-btn">↓</button>
      <button class="control-btn direction-btn" id="right-btn">→</button>
    </div>
  </div>
  <div class="game-instructions">
    <p>使用键盘方向键或WASD控制蛇移动，吃到食物可增加分数。</p>
    <p>碰到墙壁或自己的身体游戏结束。</p>
  </div>
    </div>
    
    <footer>
      © 2025 四季风景 | 像素艺术季节切换演示 & 贪吃蛇小游戏
    </footer>
  </div>
  
  <script>
    function createPixel(x, y, color) {
      const pixel = document.createElement('div');
      pixel.className = 'pixel';
      pixel.style.backgroundColor = color;
      pixel.style.gridColumn = x + 1;
      pixel.style.gridRow = y + 1;
      return pixel;
    }
    
    function createSpringScene() {
      const grid = document.getElementById('spring-grid');
      if (!grid) return console.error('spring-grid 未找到');
      grid.innerHTML = '';
      for (let y = 0; y < 32; y++) {
        for (let x = 0; x < 32; x++) {
          const skyColor = y < 20 ? '#c4e0f9' : '#7cbb5e';
          grid.appendChild(createPixel(x, y, skyColor));
        }
      }
      for (let y = 15; y < 25; y++) {
        grid.appendChild(createPixel(15, y, '#8b4513'));
        grid.appendChild(createPixel(16, y, '#8b4513'));
      }
      for (let x = 10; x < 22; x++) {
        if (x !== 15 && x !== 16) {
          grid.appendChild(createPixel(x, 14, '#8b4513'));
        }
      }
      for (let x = 12; x < 20; x++) {
        if (x !== 15 && x !== 16) {
          grid.appendChild(createPixel(x, 13, '#8b4513'));
        }
      }
      const blossomPositions = [
        [8, 12], [9, 11], [10, 12], [11, 11], [12, 12],
        [13, 11], [14, 10], [15, 9], [16, 10], [17, 11],
        [18, 12], [19, 11], [20, 12], [21, 11], [22, 12],
        [23, 13], [8, 13], [9, 14], [22, 14], [23, 15],
        [7, 11], [6, 12], [24, 12], [25, 11]
      ];
      for (const [x, y] of blossomPositions) {
        const pink = Math.random() > 0.5 ? '#ffb7c5' : '#ffc0cb';
        grid.appendChild(createPixel(x, y, pink));
      }
      const fallingPetals = [
        [5, 15], [10, 16], [18, 16], [25, 15],
        [7, 17], [13, 18], [20, 17], [26, 18],
        [9, 19], [22, 19]
      ];
      for (const [x, y] of fallingPetals) {
        grid.appendChild(createPixel(x, y, '#ffb7c5'));
      }
    }
    
    function createSummerScene() {
      const grid = document.getElementById('summer-grid');
      if (!grid) return console.error('summer-grid 未找到');
      grid.innerHTML = '';
      for (let y = 0; y < 32; y++) {
        for (let x = 0; x < 32; x++) {
          let color = y < 18 ? '#87ceeb' : y < 20 ? '#f0e68c' : '#1e90ff';
          grid.appendChild(createPixel(x, y, color));
        }
      }
      const sunCenter = [8, 5];
      const sunRadius = 4;
      for (let y = sunCenter[1] - sunRadius; y <= sunCenter[1] + sunRadius; y++) {
        for (let x = sunCenter[0] - sunRadius; x <= sunCenter[0] + sunRadius; x++) {
          if (Math.sqrt(Math.pow(x - sunCenter[0], 2) + Math.pow(y - sunCenter[1], 2)) <= sunRadius) {
            grid.appendChild(createPixel(x, y, '#ffdb58'));
          }
        }
      }
      const rays = [
        [3, 3], [4, 2], [5, 1], [8, 0], [11, 1], [12, 2], [13, 3],
        [2, 5], [1, 5], [0, 5], [14, 5], [15, 5], [16, 5],
        [3, 7], [4, 8], [5, 9], [11, 9], [12, 8], [13, 7]
      ];
      for (const [x, y] of rays) {
        grid.appendChild(createPixel(x, y, '#ffdb58'));
      }
      for (let x = 20; x < 26; x++) {
        grid.appendChild(createPixel(x, 13, '#ff6347'));
      }
      for (let x = 19; x < 27; x++) {
        grid.appendChild(createPixel(x, 14, '#ff6347'));
      }
      for (let y = 15; y < 19; y++) {
        grid.appendChild(createPixel(23, y, '#8b4513'));
      }
      const waves = [
        [3, 21], [7, 21], [11, 21], [15, 21], [19, 21], [23, 21], [27, 21],
        [1, 23], [5, 23], [9, 23], [13, 23], [17, 23], [21, 23], [25, 23], [29, 23],
        [3, 25], [7, 25], [11, 25], [15, 25], [19, 25], [23, 25], [27, 25],
        [1, 27], [5, 27], [9, 27], [13, 27], [17, 27], [21, 27], [25, 27], [29, 27]
      ];
      for (const [x, y] of waves) {
        grid.appendChild(createPixel(x, y, '#4169e1'));
      }
    }
    
    function createAutumnScene() {
      const grid = document.getElementById('autumn-grid');
      if (!grid) return console.error('autumn-grid 未找到');
      grid.innerHTML = '';
      for (let y = 0; y < 32; y++) {
        for (let x = 0; x < 32; x++) {
          let color = y < 20 ? '#ffc87c' : y % 2 === 0 ? '#cd853f' : '#d2691e';
          grid.appendChild(createPixel(x, y, color));
        }
      }
      for (let y = 10; y < 20; y++) {
        grid.appendChild(createPixel(15, y, '#8b4513'));
        grid.appendChild(createPixel(16, y, '#8b4513'));
      }
      const treeLeaves = [
        [10, 8], [11, 7], [12, 6], [13, 5], [14, 6], [15, 5], [16, 5],
        [17, 6], [18, 5], [19, 6], [20, 7], [21, 8],
        [9, 9], [10, 10], [21, 9], [22, 10],
        [12, 8], [14, 8], [17, 8], [19, 8]
      ];
      for (const [x, y] of treeLeaves) {
        const color = Math.random() > 0.5 ? '#ff8c00' : '#ff4500';
        grid.appendChild(createPixel(x, y, color));
      }
      const fallingLeaves = [
        [5, 12], [7, 14], [9, 16], [11, 18],
        [22, 12], [25, 14], [27, 16], [24, 18],
        [6, 17], [14, 15], [19, 16], [28, 15],
        [3, 19], [13, 19], [21, 19], [29, 19]
      ];
      for (const [x, y] of fallingLeaves) {
        const color = Math.random() > 0.5 ? '#ff8c00' : '#ff4500';
        grid.appendChild(createPixel(x, y, color));
      }
    }
    
    function createWinterScene() {
  const grid = document.getElementById('winter-grid');
  if (!grid) return console.error('winter-grid 未找到');
  
  grid.innerHTML = '';

  // Create sky and snow background
  for (let y = 0; y < 32; y++) {
    for (let x = 0; x < 32; x++) {
      let color = y < 20 ? '#b0c4de' : Math.random() > 0.8 ? '#f0f8ff' : '#ffffff';
      grid.appendChild(createPixel(x, y, color));
    }
  }

  // Draw snowman in the middle
  const snowmanBase = [16, 22];
  const baseRadius = 5;
  
  // Snowman base
  for (let y = snowmanBase[1] - baseRadius; y <= snowmanBase[1] + baseRadius; y++) {
    for (let x = snowmanBase[0] - baseRadius; x <= snowmanBase[0] + baseRadius; x++) {
      if (Math.sqrt(Math.pow(x - snowmanBase[0], 2) + Math.pow(y - snowmanBase[1], 2)) <= baseRadius) {
        grid.appendChild(createPixel(x, y, '#ffffff'));
      }
    }
  }

  // Snowman head
  const snowmanHead = [16, 14];
  const headRadius = 3;
  
  for (let y = snowmanHead[1] - headRadius; y <= snowmanHead[1] + headRadius; y++) {
    for (let x = snowmanHead[0] - headRadius; x <= snowmanHead[0] + headRadius; x++) {
      if (Math.sqrt(Math.pow(x - snowmanHead[0], 2) + Math.pow(y - snowmanHead[1], 2)) <= headRadius) {
        grid.appendChild(createPixel(x, y, '#ffffff'));
      }
    }
  }

  // Snowman features
  grid.appendChild(createPixel(15, 13, '#000000')); // Left eye
  grid.appendChild(createPixel(17, 13, '#000000')); // Right eye
  grid.appendChild(createPixel(16, 14, '#ff7f00')); // Carrot nose
  grid.appendChild(createPixel(15, 15, '#000000')); // Mouth
  grid.appendChild(createPixel(16, 15, '#000000')); // Mouth
  grid.appendChild(createPixel(17, 15, '#000000')); // Mouth

  // Draw boy on the right side
  const boyPositions = [
    [25, 17, '#0000ff'], [25, 18, '#0000ff'], [25, 19, '#0000ff'], // Hair
    [24, 18, '#ffdab9'], [24, 17, '#ffdab9'], [24, 19, '#ffdab9'], // Face
    [23, 18, '#ffdab9'], [23, 17, '#000000'], [23, 19, '#ff0000'], // Face features
    [25, 20, '#ff0000'], [25, 21, '#ff0000'], [25, 22, '#ff0000'], // Body
    [24, 20, '#ff0000'], [24, 21, '#ff0000'], [24, 22, '#ff0000'],
    [26, 20, '#ff0000'], [26, 21, '#ff0000'], [23, 21, '#ffdab9'],
    [27, 21, '#ffdab9'], [24, 23, '#0000ff'], [26, 23, '#0000ff'], // Legs
    [24, 24, '#0000ff'], [26, 24, '#0000ff'],
    // Boy's scarf - dark blue
    [23, 20, '#000080'], [24, 20, '#000080'], [25, 20, '#000080'], 
    [26, 20, '#000080'], [27, 20, '#000080'],
    [23, 21, '#000080'] // Scarf end
  ];

  // Draw girl on the left side
  const girlPositions = [
    [7, 17, '#8b4513'], [7, 18, '#8b4513'], [7, 19, '#8b4513'], // Hair
    [8, 18, '#ffdab9'], [8, 17, '#ffdab9'], [8, 19, '#ffdab9'], // Face
    [9, 18, '#ffdab9'], [9, 17, '#000000'], [9, 19, '#ff0000'], // Face features
    // Body - Pink dress
    [7, 20, '#ff69b4'], [7, 21, '#ff69b4'], [7, 22, '#ff69b4'],
    [8, 20, '#ff69b4'], [8, 21, '#ff69b4'], [8, 22, '#ff69b4'],
    [6, 20, '#ff69b4'], [6, 21, '#ff69b4'], [9, 21, '#ffdab9'],
    [5, 21, '#ffdab9'],
    // Legs
    [7, 23, '#000080'], [9, 23, '#000080'],
    [7, 24, '#000080'], [9, 24, '#000080'],
    // Girl's scarf - light pink
    [5, 20, '#ffc0cb'], [6, 20, '#ffc0cb'], [7, 20, '#ffc0cb'],
    [8, 20, '#ffc0cb'], [9, 20, '#ffc0cb'],
    [9, 21, '#ffc0cb'] // Scarf end
  ];

  // Draw characters
  [...boyPositions, ...girlPositions].forEach(([x, y, color]) => {
    grid.appendChild(createPixel(x, y, color));
  });

  // Add snowflakes
  const snowflakes = [
    [3, 3], [7, 5], [12, 7], [19, 4], [25, 6], [29, 3],
    [5, 10], [10, 12], [22, 10], [27, 11],
    [4, 16], [9, 19], [14, 15], [21, 14], [28, 18]
  ];

  snowflakes.forEach(([x, y]) => {
    grid.appendChild(createPixel(x, y, '#ffffff'));
  });
}
    
    function initializeScenes() {
      console.log('初始化所有场景');
      createSpringScene();
      createSummerScene();
      createAutumnScene();
      createWinterScene();
    }
    
    function changeSeason(season) {
      console.log('切换季节到：', season);
      document.querySelectorAll('.pixel-art').forEach(art => art.classList.remove('active'));
      document.querySelectorAll('.season-btn').forEach(btn => btn.classList.remove('active'));
      const seasonArt = document.getElementById(season);
      const seasonBtn = document.querySelector('.' + season + '-btn');
      if (seasonArt && seasonBtn) {
        seasonArt.classList.add('active');
        seasonBtn.classList.add('active');
        document.body.className = season;
      } else {
        console.error('未找到季节元素或按钮：', season);
      }
    }
    
    class SnakeGame {
      constructor() {
        this.canvas = document.getElementById('game-canvas');
        this.ctx = this.canvas.getContext('2d');
        if (!this.ctx) console.error('Canvas 上下文未初始化');
        this.width = this.canvas.width;
        this.height = this.canvas.height;
        this.blockSize = 20;
        this.widthInBlocks = this.width / this.blockSize;
        this.heightInBlocks = this.height / this.blockSize;
        this.score = 0;
        this.highScore = localStorage.getItem('snakeHighScore') || 0;
        this.gameOver = false;
        this.paused = false;
        this.intervalId = null;
        this.snake = [{x: 6, y: 10}, {x: 5, y: 10}, {x: 4, y: 10}];
        this.direction = 'right';
        this.nextDirection = 'right';
        this.food = this.createFood();
        this.scoreElement = document.getElementById('score');
        this.highScoreElement = document.getElementById('high-score');
        this.highScoreElement.textContent = this.highScore;
        this.initEventListeners();
      }
      
      initEventListeners() {
        document.addEventListener('keydown', this.handleKeyDown.bind(this));
  document.getElementById('start-btn').addEventListener('click', () => {
    if (this.gameOver) this.reset();
    this.start();
  });
  document.getElementById('pause-btn').addEventListener('click', () => this.togglePause());

  // 添加手机端虚拟按钮控制
  const upBtn = document.getElementById('up-btn');
  const leftBtn = document.getElementById('left-btn');
  const rightBtn = document.getElementById('right-btn');
  const downBtn = document.getElementById('down-btn');

  if (upBtn) {
    upBtn.addEventListener('click', () => {
      if (this.direction !== 'down') this.nextDirection = 'up';
    });
  }
  if (leftBtn) {
    leftBtn.addEventListener('click', () => {
      if (this.direction !== 'right') this.nextDirection = 'left';
    });
  }
  if (rightBtn) {
    rightBtn.addEventListener('click', () => {
      if (this.direction !== 'left') this.nextDirection = 'right';
    });
  }
  if (downBtn) {
    downBtn.addEventListener('click', () => {
      if (this.direction !== 'up') this.nextDirection = 'down';
    });
  }
      }
      
      handleKeyDown(e) {
        const key = e.key;
        if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'w', 'a', 's', 'd'].includes(key)) {
          e.preventDefault();
        }
        if (this.gameOver) return;
        switch(key) {
          case 'ArrowUp': case 'w': case 'W':
            if (this.direction !== 'down') this.nextDirection = 'up';
            break;
          case 'ArrowDown': case 's': case 'S':
            if (this.direction !== 'up') this.nextDirection = 'down';
            break;
          case 'ArrowLeft': case 'a': case 'A':
            if (this.direction !== 'right') this.nextDirection = 'left';
            break;
          case 'ArrowRight': case 'd': case 'D':
            if (this.direction !== 'left') this.nextDirection = 'right';
            break;
          case ' ': this.togglePause(); break;
        }
      }
      
      createFood() {
        let newFood;
        do {
          newFood = {
            x: Math.floor(Math.random() * this.widthInBlocks),
            y: Math.floor(Math.random() * this.heightInBlocks)
          };
        } while (this.snake.some(segment => segment.x === newFood.x && segment.y === newFood.y));
        return newFood;
      }
      
      drawBlock(x, y, color) {
        this.ctx.fillStyle = color;
        this.ctx.fillRect(x * this.blockSize, y * this.blockSize, this.blockSize, this.blockSize);
        this.ctx.strokeStyle = '#FFF';
        this.ctx.strokeRect(x * this.blockSize, y * this.blockSize, this.blockSize, this.blockSize);
      }
      
      drawScore() {
        this.scoreElement.textContent = this.score;
        if (this.score > this.highScore) {
          this.highScore = this.score;
          this.highScoreElement.textContent = this.highScore;
          localStorage.setItem('snakeHighScore', this.highScore);
        }
      }
      
      draw() {
        this.ctx.clearRect(0, 0, this.width, this.height);
        this.snake.forEach((segment, index) => {
          const color = index === 0 ? '#4CAF50' : '#8BC34A';
          this.drawBlock(segment.x, segment.y, color);
        });
        this.drawBlock(this.food.x, this.food.y, '#FF5722');
      }
      
      drawGameOver() {
        this.ctx.font = '30px Arial';
        this.ctx.fillStyle = '#333';
        this.ctx.textAlign = 'center';
        this.ctx.fillText('游戏结束!', this.width / 2, this.height / 2 - 15);
        this.ctx.font = '20px Arial';
        this.ctx.fillText(`最终得分: ${this.score}`, this.width / 2, this.height / 2 + 15);
        this.ctx.fillText('按开始游戏重新开始', this.width / 2, this.height / 2 + 45);
      }
      
      move() {
        if (this.paused || this.gameOver) return;
        const head = {x: this.snake[0].x, y: this.snake[0].y};
        this.direction = this.nextDirection;
        switch(this.direction) {
          case 'up': head.y--; break;
          case 'down': head.y++; break;
          case 'left': head.x--; break;
          case 'right': head.x++; break;
        }
        if (this.checkCollision(head)) {
          this.gameOver = true;
          this.drawGameOver();
          if (this.intervalId) {
            clearInterval(this.intervalId);
            this.intervalId = null;
          }
          return;
        }
        this.snake.unshift(head);
        if (head.x === this.food.x && head.y === this.food.y) {
          this.score++;
          this.drawScore();
          this.food = this.createFood();
        } else {
          this.snake.pop();
        }
        this.draw();
      }
      
      checkCollision(head) {
        if (head.x < 0 || head.x >= this.widthInBlocks || head.y < 0 || head.y >= this.heightInBlocks) {
          return true;
        }
        return this.snake.some((segment, index) => index > 0 && segment.x === head.x && segment.y === head.y);
      }
      
      start() {
        if (this.intervalId) return;
        this.paused = false;
        document.getElementById('pause-btn').textContent = '暂停';
        this.intervalId = setInterval(() => this.move(), 150);
      }
      
      togglePause() {
        if (this.gameOver) return;
        this.paused = !this.paused;
        if (this.paused) {
          document.getElementById('pause-btn').textContent = '继续';
          if (this.intervalId) {
            clearInterval(this.intervalId);
            this.intervalId = null;
          }
          this.ctx.font = '30px Arial';
          this.ctx.fillStyle = '#333';
          this.ctx.textAlign = 'center';
          this.ctx.fillText('游戏暂停', this.width / 2, this.height / 2);
        } else {
          document.getElementById('pause-btn').textContent = '暂停';
          this.start();
        }
      }
      
      reset() {
        this.snake = [{x: 6, y: 10}, {x: 5, y: 10}, {x: 4, y: 10}];
        this.direction = 'right';
        this.nextDirection = 'right';
        this.food = this.createFood();
        this.score = 0;
        this.gameOver = false;
        this.paused = false;
        this.drawScore();
        this.draw();
      }
    }
    
    // 初始化和事件绑定
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM 已加载');
      initializeScenes();
      changeSeason('spring'); // 确保默认显示春季
      
      const seasonButtons = document.querySelectorAll('.season-btn');
      console.log('找到的季节按钮数量：', seasonButtons.length);
      seasonButtons.forEach(button => {
        button.addEventListener('click', function() {
          const season = this.getAttribute('data-season');
          console.log('点击了季节按钮：', season);
          changeSeason(season);
        });
      });
      
      document.getElementById('snake-game-btn').addEventListener('click', function() {
        console.log('进入贪吃蛇游戏');
        document.querySelector('.season-container').style.display = 'none';
        document.querySelector('.season-controls').style.display = 'none';
        document.getElementById('snake-game-btn').style.display = 'none';
        document.getElementById('snake-game').style.display = 'block';
        
        const game = new SnakeGame();
        
        document.getElementById('back-btn').addEventListener('click', function() {
          if (game.intervalId) {
            clearInterval(game.intervalId);
          }
          console.log('返回风景页面');
          document.querySelector('.season-container').style.display = 'block';
          document.querySelector('.season-controls').style.display = 'flex';
          document.getElementById('snake-game-btn').style.display = 'block';
          document.getElementById('snake-game').style.display = 'none';
        });
      });
    });
  </script>
</body>
</html>